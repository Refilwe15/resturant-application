<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Edit Food</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Inter',sans-serif; margin:0; background:#f8f8f8; display:flex; min-height:100vh; }
    .sidebar { width:250px; background:#FF6B35; color:#fff; padding:20px; display:flex; flex-direction:column; }
    .sidebar h2 { margin-bottom:30px; text-align:center; }
    .sidebar a { color:#fff; text-decoration:none; padding:12px; margin-bottom:10px; border-radius:8px; display:block; }
    .sidebar a:hover { background:#FF4A1A; }
    .main { flex:1; padding:30px; }
    h1 { color:#FF6B35; margin-bottom:20px; }
    form { background:#fff; padding:20px; border-radius:10px; max-width:500px; }
    input, select { width:100%; padding:10px; margin-bottom:12px; border-radius:6px; border:1px solid #ccc; }
    button { padding:10px 20px; border:none; border-radius:6px; background:#FF6B35; color:#fff; cursor:pointer; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Admin Panel</h2>
    <a href="/admin/dashboard">Dashboard</a>
    <a href="/admin/foods" class="active">Manage Foods</a>
    <a href="/admin/orders">Orders</a>
    <a href="/admin/foods/add">Add Food</a>
    <a href="#" onclick="logout()">Logout</a>
  </div>

  <div class="main">
    <h1>Edit Food</h1>
    <form id="editForm" enctype="multipart/form-data">
      <input type="hidden" name="id" id="foodId" />
      <input type="text" name="name" placeholder="Food Name" required />
      <input type="number" name="price" placeholder="Price" required />
      <input type="text" name="description" placeholder="Description" />
      <select name="type">
        <option value="Burgers">Burgers</option>
        <option value="Sides">Sides</option>
        <option value="Desserts">Desserts</option>
        <option value="Drinks">Drinks</option>
      </select>
      <input type="file" name="image" />
      <button type="submit">Save Changes</button>
    </form>
  </div>

  <script>
    const token = localStorage.getItem("adminToken");
    const API = "/api/foods";
    const form = document.getElementById("editForm");

    const id = window.location.pathname.split("/").pop();

    async function loadFood() {
      const res = await fetch(`${API}/${id}`, { headers:{ Authorization:`Bearer ${token}` } });
      const food = await res.json();
      form.foodId.value = food.id;
      form.name.value = food.name;
      form.price.value = food.price;
      form.description.value = food.description;
      form.type.value = food.type;
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      await fetch(`${API}/${id}`, { method:"PUT", headers:{ Authorization:`Bearer ${token}` }, body: formData });
      alert("Food updated!");
      location.href="/admin/foods";
    });

    loadFood();

    function logout() { localStorage.removeItem("adminToken"); location.href="/admin"; }
  </script>
</body>
</html>
